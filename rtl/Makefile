.PHONY: top

# cocotb/iverilog for actual testing
# verilator for full simulation of the project (speed purposes)

VERILATOR= $(shell which verilator)
HARNESSES= harnesses
OBJ_DIR= obj_dir
TESTS= tests

# `make simulate` simulates the entire FPGA with verilator for speed purposes. Run this and change the 2PGATest.cpp file to see how the design works.
# This automatically generates a vcd file called `2PGA_VERILATOR.vcd`. In theory it shouldn't differ from the ones generated by cocotb
simulate_clb: CLB.cpp CLB.sv
	$(VERILATOR) -I. -Wall -Wno-fatal --trace --cc --exe --build $(HARNESSES)/CLB.cpp CLB.sv
	$(OBJ_DIR)/VCLB


test_clb:
	$(VERILATOR) -I. -Wall -Wno-fatal --trace --cc --exe --build $(TESTS)/template.cpp CLB.sv
	$(OBJ_DIR)/VCLB > printout.txt
	cat printout.txt
